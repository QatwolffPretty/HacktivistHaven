<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Sign In • Hacktivist Haven</title>
<link rel="stylesheet" href="signin.css">
</head>
<body>

<div class="wrap">
  <div class="login-box glass">

    <div class="logo-holder">
      <img src="forum-bg.png" alt="logo" class="logo">
    </div>

    <h2 class="title">Hacktivist Haven</h2>
    <p class="tagline">Student Forum & Admin Panel</p>

    <!-- SWITCH TABS -->
    <div class="tabs">
      <button class="tab active" data-tab="student-login">Student Login</button>
      <button class="tab" data-tab="admin-login">Admin Login</button>
      <button class="tab" data-tab="student-register">Student Register</button>
      <button class="tab" data-tab="admin-register">Admin Register</button>
    </div>

    <!-- ✅ STUDENT LOGIN -->
    <form class="form active" id="student-login" action="/backend/signin.php" method="POST">
      <input type="hidden" name="role" value="student">
      <label>Username <br><small class="bm">Nama Pengguna</small></label>
      <input type="text" name="username" required>

      <label>Password <br><small class="bm">Kata Laluan</small></label>
      <input type="password" name="password" required>
      <button class="btn">Login Student</button>
    </form>

    <!-- ✅ ADMIN LOGIN -->
    <form class="form" id="admin-login" action="backend/signin.php" method="POST">
      <input type="hidden" name="role" value="admin">
      <label>Admin Username<br><small class="bm">Nama Pengguna Admin</small></label>
      <input type="text" name="username" required>

      <label>Password<br><small class="bm">Kata Laluan</small></label>
      <input type="password" name="password" required>
      <button class="btn">Login Admin</button>
    </form>

    <!-- ✅ STUDENT REGISTER -->
    <form class="form" id="student-register" action="/backend/register.php" method="POST">
      <input type="hidden" name="role" value="student">

      <label>Full Name<br><small class="bm">Nama Penuh</small></label>
      <input type="text" name="fullname" required>

      <label>Username<br><small class="bm">Nama Pengguna</small></label>
      <input type="text" name="username" required>

      <label>Email<br><small class="bm">Emel</small></label>
      <input type="email" name="email" required>

      <label>Country<br><small class="bm">Negara</small></label>
      <input type="text" name="country" required>

      <label>Telegram ID<br><small class="bm">ID Telegram</small></label>
      <input type="text" name="telegram" required>

      <label>Password<br><small class="bm">Kata Laluan</small></label>
      <input type="password" name="password" required>

      <button class="btn">Register Student</button>
    </form>

    <!-- ✅ ADMIN REGISTER -->
    <form class="form" id="admin-register" action="/backend/signin.php" method="POST">
      <input type="hidden" name="role" value="admin">

      <label>Admin Full Name<br><small class="bm">Nama Penuh Admin</small></label>
      <input type="text" name="fullname" required>

      <label>Admin Username<br><small class="bm">Nama Pengguna Admin</small></label>
      <input type="text" name="username" required>

      <label>Email<br><small class="bm">Emel</small></label>
      <input type="email" name="email" required>

      <label>Country<br><small class="bm">Negara</small></label>
      <input type="text" name="country" required>

      <label>Telegram ID<br><small class="bm">ID Telegram</small></label>
      <input type="text" name="telegram" required>

      <label>Password<br><small class="bm">Kata Laluan</small></label>
      <input type="password" name="password" required>

      <button class="btn">Register Admin</button>
    </form>

  </div>
</div>

  <script>
    // ✅ Tab Switching (KEEP this)
    document.querySelectorAll('.tab').forEach(tab=>{
      tab.addEventListener('click',()=>{
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        document.querySelectorAll('.form').forEach(f=>f.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });
    

    <!-- ✅ ADD THIS NEW SCRIPT BELOW -->

      document.querySelectorAll("form").forEach(form => {
        form.addEventListener("submit", async (e) => {

          if (!form.action.includes("signin.php")) return;

          e.preventDefault();
          const formData = new FormData(form);

          const res = await fetch(form.action, { method: "POST", body: formData });
          const data = await res.json();

          if (data.success) {
            // ✅ Save user for Community greeting
            localStorage.setItem("hh_user", JSON.stringify({
              username: formData.get("username"),
              role: formData.get("role")
            }));

            window.location.href = data.redirect;
          } else {
            alert(data.error);
          }
        });
      });

      loginForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const form = e.target;
        const data = new FormData(form);

        const res = await fetch(form.action, {
          method: "POST",
          body: data
        });

        const result = await res.json();
        if (result.success) {
          if (result.user) {
            localStorage.setItem("hh_user", JSON.stringify(result.user));
          }
          window.location.href = result.redirect;
        } else {
          alert(result.error || "Login failed");
        }
      });


    </script>



</body>
</html>
